<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ç‹¼äººæ®ºéŠæˆ²</title>

</head>
<body>

  <!-- éŠæˆ²æ¨™é¡Œ -->
  <header>
    <h1>ğŸº ç‹¼äººæ®º</h1>
    
  </header>

  <!-- éŠæˆ²è¨­å®šç•«é¢ -->
  <section id="setup">
    <h2>éŠæˆ²è¨­å®š</h2>
    <label>ç©å®¶äººæ•¸ï¼š
      <input type="number" id="playerCount" min="4" max="12" value="8">
    </label>
    <button id="startGame">é–‹å§‹éŠæˆ²</button>
  </section>

  <!-- éŠæˆ²ä¸»ç•«é¢ -->
  <main id="game" hidden>

    <!-- å›åˆè³‡è¨Š -->
    <section id="status">
      <h2>ç›®å‰ç‹€æ…‹</h2>
      <p>å›åˆï¼š<span id="round">å¤œæ™š</span></p>
      <p>å­˜æ´»ç©å®¶ï¼š<span id="aliveCount"></span></p>
    </section>

    <!-- ç©å®¶å€ -->
    <section id="players">
      <h2>ç©å®¶</h2>
      <ul id="playerList">
        <!-- JS å‹•æ…‹ç”¢ç”Ÿç©å®¶ -->
      </ul>
    </section>

    <!-- è¡Œå‹•å€ -->
    <section id="actions">
      <h2>è¡Œå‹•</h2>
      <button id="killBtn">ç‹¼äººè¡Œå‹•</button>
      <button id="voteBtn">ç™½å¤©æŠ•ç¥¨</button>
    </section>

    <!-- è¨Šæ¯ç´€éŒ„ -->
    <section id="log">
      <h2>éŠæˆ²ç´€éŒ„</h2>
      <div id="logContent"></div>
    </section>

  </main>

  <!-- é å°¾ -->
  <footer>
    <p>Â© 2025 ç‹¼äººæ®ºéŠæˆ²</p>
  </footer>

  <!-- JavaScript -->
  <script src="script.js"></script>
</body>
</html>

<script>// ===== ç‹¼äººæ®º åŸºç¤éŠæˆ²é‚è¼¯ =====

const startBtn = document.getElementById("startGame");
const setup = document.getElementById("setup");
const game = document.getElementById("game");
const playerList = document.getElementById("playerList");
const aliveCountSpan = document.getElementById("aliveCount");
const roundSpan = document.getElementById("round");
const logContent = document.getElementById("logContent");
const killBtn = document.getElementById("killBtn");
const voteBtn = document.getElementById("voteBtn");

let players = [];
let phase = "night"; // night | day

// ===== ç©å®¶ç‰©ä»¶ =====
function createPlayers(count) {
  const roles = [];
  roles.push("ç‹¼äºº", "ç‹¼äºº");
  roles.push("é è¨€å®¶");
  while (roles.length < count) {
    roles.push("å¹³æ°‘");
  }

  shuffle(roles);

  players = roles.map((role, index) => ({
    id: index + 1,
    name: `ç©å®¶ ${index + 1}`,
    role,
    alive: true
  }));
}

// ===== æ´—ç‰Œ =====
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

// ===== é¡¯ç¤ºç©å®¶ =====
function renderPlayers() {
  playerList.innerHTML = "";
  players.forEach(p => {
    const li = document.createElement("li");
    li.textContent = `${p.name} - ${p.alive ? "å­˜æ´»" : "æ­»äº¡"}`;
    if (!p.alive) li.style.textDecoration = "line-through";
    playerList.appendChild(li);
  });
  aliveCountSpan.textContent = players.filter(p => p.alive).length;
}

// ===== ç´€éŒ„è¨Šæ¯ =====
function log(msg) {
  const p = document.createElement("p");
  p.textContent = msg;
  logContent.appendChild(p);
}

// ===== é–‹å§‹éŠæˆ² =====
startBtn.onclick = () => {
  const count = Number(document.getElementById("playerCount").value);
  createPlayers(count);
  setup.hidden = true;
  game.hidden = false;
  phase = "night";
  roundSpan.textContent = "å¤œæ™š";
  logContent.innerHTML = "";
  log("éŠæˆ²é–‹å§‹ï¼Œå¤œæ™šé™è‡¨...");
  renderPlayers();
};

// ===== ç‹¼äººå¤œæ™šè¡Œå‹• =====
killBtn.onclick = () => {
  if (phase !== "night") return alert("ç¾åœ¨ä¸æ˜¯å¤œæ™šï¼");

  const targets = players.filter(p => p.alive && p.role !== "ç‹¼äºº");
  if (targets.length === 0) return;

  const victim = targets[Math.floor(Math.random() * targets.length)];
  victim.alive = false;
  log(`ğŸŒ™ å¤œæ™šï¼š${victim.name} è¢«ç‹¼äººæ®ºå®³`);

  phase = "day";
  roundSpan.textContent = "ç™½å¤©";
  renderPlayers();
  checkWin();
};

// ===== ç™½å¤©æŠ•ç¥¨ =====
voteBtn.onclick = () => {
  if (phase !== "day") return alert("ç¾åœ¨ä¸æ˜¯ç™½å¤©ï¼");

  const targets = players.filter(p => p.alive);
  const voted = targets[Math.floor(Math.random() * targets.length)];
  voted.alive = false;
  log(`â˜€ï¸ ç™½å¤©ï¼š${voted.name} è¢«æŠ•ç¥¨è™•åˆ‘`);

  phase = "night";
  roundSpan.textContent = "å¤œæ™š";
  renderPlayers();
  checkWin();
};

// ===== å‹è² åˆ¤æ–· =====
function checkWin() {
  const alive = players.filter(p => p.alive);
  const wolves = alive.filter(p => p.role === "ç‹¼äºº");
  const humans = alive.filter(p => p.role !== "ç‹¼äºº");

  if (wolves.length === 0) {
    log("ğŸ‰ å¥½äººé™£ç‡Ÿå‹åˆ©ï¼");
    disableActions();
  } else if (wolves.length >= humans.length) {
    log("ğŸ’€ ç‹¼äººé™£ç‡Ÿå‹åˆ©ï¼");
    disableActions();
  }
}

function disableActions() {
  killBtn.disabled = true;
  voteBtn.disabled = true;
}
</script>
